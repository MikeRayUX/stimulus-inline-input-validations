var d=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var u=Object.prototype.hasOwnProperty;var h=(t,e,a)=>e in t?d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var f=(t,e)=>{for(var a in e)d(t,a,{get:e[a],enumerable:!0})},b=(t,e,a,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of g(e))!u.call(t,i)&&i!==a&&d(t,i,{get:()=>e[i],enumerable:!(s=p(e,i))||s.enumerable});return t};var y=t=>b(d({},"__esModule",{value:!0}),t);var c=(t,e,a)=>(h(t,typeof e!="symbol"?e+"":e,a),a);var w={};f(w,{InputValidator:()=>o});module.exports=y(w);var m=require("@hotwired/stimulus");var A={numericality:/^[+-]?(\d+(\.\d*)?|\.\d+)([eE][+-]?\d+)?$/,email:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,singleNumber:/[0-9]/,singleCapitalLetter:/[A-Z]/,singleSpecialCharacter:/[!@#$%^&*]/,singleQuotes:/'/},r=A;var x={presence(t,e){t.trim().length===0&&e.push({type:"presence",message:"Can't be blank"})},length(t,e,a){t.length<e.min&&a.push({type:"length-min",message:`Too short. Minimum ${e.min} characters`}),t.length>e.max&&a.push({type:"length-max",message:`Too long. Maximum ${e.max} characters`})},numericality(t,e){r.numericality.test(t)||e.push({type:"numericality",message:"Must be a number"})},email(t,e){r.email.test(t)||e.push({type:"email",message:"Invalid email format"})},strongPassword(t,e,a){r.singleCapitalLetter.test(e)||a.push({type:"strong-password-capital-letter",message:"Must contain at least one capital letter (A-Z)"}),r.singleNumber.test(e)||a.push({type:"strong-password-number",message:"Must contain at least one number"}),r.singleSpecialCharacter.test(e)||a.push({type:"strong-password-special-character",message:"Must contain at least one special character (!@#$%^&*)"}),!(t.length&&t.some(s=>Object.keys(s).includes("length")))&&e.length<10&&a.push({type:"strong-password-length",message:"Must be at least 10 characters long"})}},l=x;var o=class extends m.Controller{connect(){this.fieldTargets.forEach(t=>{t.setAttribute("data-action","input->input-validator#validateInput"),t.addEventListener("blur",e=>{this.validateInput(e)})})}handleJSONValidations(t,e,a){e.forEach(s=>{let[i]=Object.keys(s);switch(i){case"presence":s.presence&&l.presence(t,a);break;case"length":s.length.min&&s.length.max?l.length(t,s.length,a):console.log("Couldn't validate length (missing keys min or max)");break;case"numericality":s.numericality&&l.numericality(t,a);break;case"email":s.email&&l.email(t,a);break;case"strong_password":s.strong_password&&l.strongPassword(e,t,a);break;default:break}})}handleValidations(t,e,a){if(t.hasAttribute("data-validates-presence")&&t.getAttribute("data-validates-presence")!=="false"&&l.presence(e,a),t.hasAttribute("data-validates-length")&&t.getAttribute("data-validates-length").length>2){let[s,i]=t.getAttribute("data-validates-length").split(",").map(Number);l.length(e,{min:s,max:i},a)}t.hasAttribute("data-validates-numericality")&&t.getAttribute("data-validates-numericality")!=="false"&&l.numericality(e,a),t.hasAttribute("data-validates-email")&&t.getAttribute("data-validates-email")!=="false"&&l.email(e,a),t.hasAttribute("data-validates-strong-password")&&t.getAttribute("data-validates-strong-password")!=="false"&&l.strongPassword([],e,a)}errorElement(t,e){let a="font-size: 14px; color: red",s;return t.hasAttribute("data-errors-styles-css")&&(a=t.getAttribute("data-errors-styles-css")),t.hasAttribute("data-errors-styles-class")&&(a=null,s=t.getAttribute("data-errors-styles-class")),`<div error="${e.type}" ${a?"style='"+a+"'":""} ${s?"class='"+s+"'":""} >${e.message}</div>`}validateInput({target:t,target:{value:e}}){let a=[],s=t.getAttribute("data-field");if(!s){console.log('one or more <input> elements are the missing data-field="" attribute.');return}let[i]=this.errorsTargets.filter(n=>n.getAttribute("data-field")===s);if(t.hasAttribute("data-validations"))try{let n=t.getAttribute("data-validations");r.singleQuotes.test(n)&&(n=n.replace(/'/g,'"')),this.handleJSONValidations(e,JSON.parse(n),a)}catch(n){console.log(n),console.log(`Error parsing JSON string on the data-validations attribute on data-field="${s}". Is the json string formatted properly?`);return}else this.handleValidations(t,e,a);i.innerHTML="",a.length?a.forEach(n=>{i.innerHTML+=this.errorElement(i,n),i.style.visibility="visible"}):i.style.visibility="invisible"}};c(o,"targets",["field","errors"]);
